import logging
import os
import datetime
import socket
import sys
import system.log_config as log_config
from PyQt5.QtWidgets import QMessageBox

#environ variables
Login_fail_count = 0
LOGGED_IN = False
work_order_part_no = ''
work_order = ''
qty = 0
need_to_save_info = False

#computer file variables
HOST_NAME = socket.gethostname()
HOME_PATH = os.path.expanduser("~")
__PROGRAM_NAME__ = "Ruby_Program"
EXE_BASE_PATH = "C:\\Program Files (x86)\\{0}\\{0}\\".format(__PROGRAM_NAME__)
SYST_BASE_PATH = "C:\\WINDOWS\\system32"
GIT_BASE_PATH = "C:\\Users\\cbrochu\\Documents\\GitHub"
base_path = os.getcwd()
base = ""
base = EXE_BASE_PATH if base_path == SYST_BASE_PATH else base_path
logging.info(base)
SHAKER_BASE = os.path.join(base, __PROGRAM_NAME__)
WINDOWS_BASE = base + "\window"
POWER_BASE = "X:\Engineering\Engineers Folders\Cameron Brochu\Ruby Info\Ruby Assembly"
EXCEL_BASE = "X:\Engineering\Engineers Folders\Cameron Brochu\Ruby Info\Ruby Calibration"
LABEL_BASE = "X:\Production\LabelDesigns\Brady_Print_Server_Repo_Channel_2\Print_Records"
PRINT_BASE = "X:\Production\LabelDesigns\Brady_Print_Server_Repo_Channel_2"
API_URL = "http://192.168.3.11/api"
M2M_API_URL = "http://192.168.3.11/m2mapi"


#log file info
LOG_ID = datetime.datetime.now().strftime("%Y%m%d%H%M%S")
log_file_directory = f"{HOME_PATH}\\{HOST_NAME}\\{__PROGRAM_NAME__}_Error_Logs"
log_file_path = os.path.join(log_file_directory, f"error_log_{LOG_ID}")
LOG_DATE_TIME = "%Y%m%d%H%M%S"
LOG_LEVEL = logging.INFO
log_config.init_directory(log_file_path)

print("creating log folder")
date_time = datetime.datetime.now().strftime(LOG_DATE_TIME)
log_format = "%(asctime)s (%(filename)s).%(funcName)s(%(lineno)d) - %(message)s"
print(f"log file is created here: {log_file_path}")

logging.basicConfig(
    filename=os.path.join(log_file_path, "error.log"),
    level=LOG_LEVEL,
    format=log_format,
    force=True,
)
logging.getLogger(__name__).addHandler(logging.StreamHandler(sys.stdout))
logging.info("logging setup correctly!")
print("logging setup correctly")


#help statements
MAIN_HELP_LINK = "link not available"
LOGIN_HELP_LINK = "link not available"
SBT_HELP_LINK = "link not available"

#popup messages (no user input)
def error_message(error_message: str):
    logging.info(f"Error message popup: {error_message}")
    dlg = QMessageBox()
    dlg.setWindowTitle("Error")
    dlg.setText(error_message)
    dlg.exec()
    return

def message(message: str):
    logging.info(f"message popup: {message}")
    dlg = QMessageBox()
    dlg.setWindowTitle("Message")
    dlg.setText(message)
    dlg.exec()
    return

def help_message(help_message: str, name: str =''):
    logging.info(f"help message popup: {help_message}")
    dlg = QMessageBox()
    dlg.setWindowTitle(f"{name} Help Message")
    dlg.setText(help_message)
    dlg.exec()
    return

ruby_conversion_chart = {
    "Part_number":"model_number",
    "02550431-1112" : "JMHA-100-1-S-0.5",
    "02550431-1113" : "JMHA-100-1-S-1.0",
    "02550431-1114" : "JMHA-100-1-S-2.0",
    "02550431-1116" : "JMHA-100-1-S-4.0",
    "02550431-1118" : "JMHA-100-1-S-10.0",
    "02550431-1122" : "JMHA-100-1-D-0.5",
    "02550431-1123" : "JMHA-100-1-D-1.0",
    "02550431-1124" : "JMHA-100-1-D-2.0",
    "02550431-1126" : "JMHA-100-1-D-4.0",
    "02550431-1128" : "JMHA-100-1-D-10.0",
    "02550431-1132" : "JMHA-100-1-L-0.5",
    "02550431-1133" : "JMHA-100-1-L-1.0",
    "02550431-1134" : "JMHA-100-1-L-2.0",
    "02550431-1136" : "JMHA-100-1-L-4.0",
    "02550431-1138" : "JMHA-100-1-L-10.0",
    "02550431-1412" : "JMHA-100-4-S-0.5",
    "02550431-1413" : "JMHA-100-4-S-1.0",
    "02550431-1414" : "JMHA-100-4-S-2.0",
    "02550431-1416" : "JMHA-100-4-S-4.0",
    "02550431-1418" : "JMHA-100-4-S-10.0",
    "02550431-1422" : "JMHA-100-4-D-0.5",
    "02550431-1423" : "JMHA-100-4-D-1.0",
    "02550431-1424" : "JMHA-100-4-D-2.0",
    "02550431-1426" : "JMHA-100-4-D-4.0",
    "02550431-1428" : "JMHA-100-4-D-10.0",
    "02550431-1432" : "JMHA-100-4-L-0.5",
    "02550431-1433" : "JMHA-100-4-L-1.0",
    "02550431-1434" : "JMHA-100-4-L-2.0",
    "02550431-1436" : "JMHA-100-4-L-4.0",
    "02550431-1438" : "JMHA-100-4-L-10.0",
    "02550431-2112" : "JMHA-200-1-S-0.5",
    "02550431-2113" : "JMHA-200-1-S-1.0",
    "02550431-2114" : "JMHA-200-1-S-2.0",
    "02550431-2116" : "JMHA-200-1-S-4.0",
    "02550431-2118" : "JMHA-200-1-S-10.0",
    "02550431-2122" : "JMHA-200-1-D-0.5",
    "02550431-2123" : "JMHA-200-1-D-1.0",
    "02550431-2124" : "JMHA-200-1-D-2.0",
    "02550431-2126" : "JMHA-200-1-D-4.0",
    "02550431-2128" : "JMHA-200-1-D-10.0",
    "02550431-2132" : "JMHA-200-1-L-0.5",
    "02550431-2133" : "JMHA-200-1-L-1.0",
    "02550431-2134" : "JMHA-200-1-L-2.0",
    "02550431-2136" : "JMHA-200-1-L-4.0",
    "02550431-2138" : "JMHA-200-1-L-10.0",
    "02550431-2412" : "JMHA-200-4-S-0.5",
    "02550431-2413" : "JMHA-200-4-S-1.0",
    "02550431-2414" : "JMHA-200-4-S-2.0",
    "02550431-2416" : "JMHA-200-4-S-4.0",
    "02550431-2418" : "JMHA-200-4-S-10.0",
    "02550431-2422" : "JMHA-200-4-D-0.5",
    "02550431-2423" : "JMHA-200-4-D-1.0",
    "02550431-2424" : "JMHA-200-4-D-2.0",
    "02550431-2426" : "JMHA-200-4-D-4.0",
    "02550431-2428" : "JMHA-200-4-D-10.0",
    "02550431-2432" : "JMHA-200-4-L-0.5",
    "02550431-2433" : "JMHA-200-4-L-1.0",
    "02550431-2434" : "JMHA-200-4-L-2.0",
    "02550431-2436" : "JMHA-200-4-L-4.0",
    "02550431-2438" : "JMHA-200-4-L-10.0",
    "02550431-3112" : "JMHA-300-1-S-0.5",
    "02550431-3113" : "JMHA-300-1-S-1.0",
    "02550431-3114" : "JMHA-300-1-S-2.0",
    "02550431-3116" : "JMHA-300-1-S-4.0",
    "02550431-3118" : "JMHA-300-1-S-10.0",
    "02550431-3122" : "JMHA-300-1-D-0.5",
    "02550431-3123" : "JMHA-300-1-D-1.0",
    "02550431-3124" : "JMHA-300-1-D-2.0",
    "02550431-3126" : "JMHA-300-1-D-10.0",
    "02550431-3128" : "JMHA-300-1-D-10.0",
    "02550431-3132" : "JMHA-300-1-L-0.5",
    "02550431-3133" : "JMHA-300-1-L-1.0",
    "02550431-3134" : "JMHA-300-1-L-2.0",
    "02550431-3136" : "JMHA-300-1-L-4.0",
    "02550431-3138" : "JMHA-300-1-L-10.0",
    "02550431-3412" : "JMHA-300-4-S-0.5",
    "02550431-3413" : "JMHA-300-4-S-1.0",
    "02550431-3414" : "JMHA-300-4-S-2.0",
    "02550431-3416" : "JMHA-300-4-S-4.0",
    "02550431-3418" : "JMHA-300-4-S-10.0",
    "02550431-3422" : "JMHA-300-4-D-0.5",
    "02550431-3423" : "JMHA-300-4-D-1.0",
    "02550431-3424" : "JMHA-300-4-D-2.0",
    "02550431-3426" : "JMHA-300-4-D-4.0",
    "02550431-3428" : "JMHA-300-4-D-10.0",
    "02550431-3432" : "JMHA-300-4-L-0.5",
    "02550431-3433" : "JMHA-300-4-L-1.0",
    "02550431-3434" : "JMHA-300-4-L-2.0",
    "02550431-3436" : "JMHA-300-4-L-4.0",
    "02550431-3438" : "JMHA-300-4-L-10.0",
    "02550433-1112" : "JMHI-100-1-S-1",
    "02550433-1113" : "JMHI-100-1-S-3",
    "02550433-1114" : "JMHI-100-1-S-14.5",
    "02550433-1116" : "JMHI-100-1-S-30",
    "02550433-1118" : "JMHI-100-1-S-60",
    "02550433-1119" : "JMHI-100-1-S-90",
    "02550433-1122" : "JMHI-100-1-D-1",
    "02550433-1123" : "JMHI-100-1-D-3",
    "02550433-1124" : "JMHI-100-1-D-14.5",
    "02550433-1126" : "JMHI-100-1-D-30",
    "02550433-1128" : "JMHI-100-1-D-60",
    "02550433-1129" : "JMHI-100-1-D-90",
    "02550433-1132" : "JMHI-100-1-L-1",
    "02550433-1133" : "JMHI-100-1-L-3",
    "02550433-1134" : "JMHI-100-1-L-14.5",
    "02550433-1136" : "JMHI-100-1-L-30",
    "02550433-1138" : "JMHI-100-1-L-60",
    "02550433-1139" : "JMHI-100-1-L-90",
    "02550433-1412" : "JMHI-100-4-S-1",
    "02550433-1413" : "JMHI-100-4-S-3",
    "02550433-1414" : "JMHI-100-4-S-14.5",
    "02550433-1416" : "JMHI-100-4-S-30",
    "02550433-1418" : "JMHI-100-4-S-60",
    "02550433-1419" : "JMHI-100-4-S-90",
    "02550433-1422" : "JMHI-100-4-D-1",
    "02550433-1423" : "JMHI-100-4-D-3",
    "02550433-1424" : "JMHI-100-4-D-14.5",
    "02550433-1426" : "JMHI-100-4-D-30",
    "02550433-1428" : "JMHI-100-4-D-60",
    "02550433-1429" : "JMHI-100-1-D-90",
    "02550433-1432" : "JMHI-100-4-L-1",
    "02550433-1433" : "JMHI-100-4-L-3",
    "02550433-1434" : "JMHI-100-4-L-14.5",
    "02550433-1436" : "JMHI-100-4-L-30",
    "02550433-1438" : "JMHI-100-4-L-60",
    "02550433-1439" : "JMHI-100-4-L-90",
    "02550433-2112" : "JMHI-200-1-S-1",
    "02550433-2113" : "JMHI-200-1-S-1",
    "02550433-2114" : "JMHI-200-1-S-14.5",
    "02550433-2116" : "JMHI-200-1-S-30",
    "02550433-2118" : "JMHI-200-1-S-60",
    "02550433-2119" : "JMHI-200-1-S-90",
    "02550433-2122" : "JMHI-200-1-D-1",
    "02550433-2123" : "JMHI-200-1-D-3",
    "02550433-2124" : "JMHI-200-1-D-14.5",
    "02550433-2126" : "JMHI-200-1-D-30",
    "02550433-2128" : "JMHI-200-1-D-60",
    "02550433-2129" : "JMHI-200-1-D-90.0",
    "02550433-2132" : "JMHI-200-1-L-1",
    "02550433-2133" : "JMHI-200-1-L-3",
    "02550433-2134" : "JMHI-200-1-L-14.5",
    "02550433-2136" : "JMHI-200-1-L-30",
    "02550433-2138" : "JMHI-200-1-L-60",
    "02550433-2139" : "JMHI-200-1-L-90",
    "02550433-2412" : "JMHI-200-4-S-1",
    "02550433-2413" : "JMHI-200-4-S-3",
    "02550433-2414" : "JMHI-200-4-S-14.5",
    "02550433-2416" : "JMHI-200-4-S-30",
    "02550433-2418" : "JMHI-200-4-S-60",
    "02550433-2419" : "JMHI-200-4-S-90",
    "02550433-2422" : "JMHI-200-4-D-1",
    "02550433-2423" : "JMHI-200-4-D-3",
    "02550433-2424" : "JMHI-200-4-D-14.5",
    "02550433-2426" : "JMHI-200-4-D-30",
    "02550433-2428" : "JMHI-200-4-D-60",
    "02550433-2429" : "JMHI-200-4-D-90.0",
    "02550433-2432" : "JMHI-200-4-L-1",
    "02550433-2433" : "JMHI-200-4-L-3",
    "02550433-2434" : "JMHI-200-4-L-14.5",
    "02550433-2436" : "JMHI-200-4-L-30",
    "02550433-2438" : "JMHI-200-4-L-60",
    "02550433-2439" : "JMHI-200-4-L-90",
    "02550444-2414" : "JMHI-200-4-S-14.5-V",
    "02550444-2416" : "JMHI-200-4-S-30-V",
    "02550444-2418" : "JMHI-200-4-S-60-V",
    "02550444-2419" : "JMHI-200-4-S-90-V",
    "02550444-2424" : "JMHI-200-4-D-14.5-V",
    "02550444-2426" : "JMHI-200-4-D-30-V",
    "02550444-2428" : "JMHI-200-4-D-60-V",
    "02550444-2429" : "JMHI-200-4-D-90.0-V",
    "02550444-2434" : "JMHI-200-4-L-14.5-V",
    "02550444-2436" : "JMHI-200-4-L-30-V",
    "02550444-2438" : "JMHI-200-4-L-60-V",
    "02550444-2439" : "JMHI-200-4-L-90-V"
}

available_resistors = [
    "0","1","1.02","1.05","1.07","1.1","1.13","1.15","1.18","1.21","1.24","1.27","1.3","1.33","1.37","1.4","1.43","1.47","1.5","1.54","1.58","1.62","1.65","1.69","1.74","1.78","1.82","1.87",
    "1.91","1.96","2","2.05","2.1","2.21","2.26","2.32","2.37","2.43","2.49","2.55","2.61","2.67","2.74","2.8","2.87","2.94","3.01","3.09","3.16","3.24","3.32","3.4","3.48","3.57","3.65",
    "3.74","3.83","3.92","4.02","4.12","4.22","4.32","4.42","4.53","4.64","4.75","4.87","4.99","5.11","5.23","5.36","5.49","5.62","5.76","5.9","6.04","6.19","6.34","6.49","6.65","6.81","6.98",
    "7.15","7.32","7.5","7.68","7.87","8.06","8.25","8.45","8.66","8.87","9.09","9.31","9.53","9.76","10","10.2","10.5","10.7","11","11.3","11.5","11.8","12.1","12.4","12.7","13","13.3","13.7",
    "14","14.3","14.7","15","15.4","15.8","16.2","16.5","16.9","17.4","17.8","18.2","18.7","19.1","19.6","20","20.5","21","22.1","22.6","23.2","23.7","24.3","24.9","25.5","26.1","26.7","27.4",
    "28","28.7","29.4","30.1","30.9","31.6","32.4","33.2","34","34.8","35.7","36.5","37.4","38.3","39.2","40.2","41.2","42.2","43.2","44.2","45.3","46.4","47.5","48.7","49.9","51.1","52.3",
    "53.6","54.9","56.2","57.6","59","60.4","61.9","63.4","64.9","66.5","68.1","69.8","71.5","73.2","75","76.8","78.7","80.6","82.5","84.5","86.6","88.7","90.9","93.1","95.3","97.6","100","102",
    "105","107","110","113","115","118","121","124","127","130","133","137","140","143","147","150","154","158","162","165","169","174","178","182","187","191","196","200","205","210","221",
    "226","232","237","243","249","255","261","267","274","280","287","294","301","309","316","324","332","340","348","357","365","374","383","392","402","412","422","432","442","453","464",
    "475","487","499","511","523","536","549","562","576","590","604","619","634","649","665","681","698","715","732","750","768","787","806","825","845","866","887","909","931","953","976",
    "1000","1020","1050","1070","1100","1130","1150","1180","1210","1240","1270","1300","1330","1370","1400","1430","1470","1500","1540","1580","1620","1650","1690","1740","1780","1820","1870",
    "1910","1960","2000","2050","2100","2210","2260","2320","2370","2430","2490","2550","2610","2670","2740","2800","2870","2940","3010","3090","3160","3240","3320","3400","3480","3570","3650",
    "3740","3830","3920","4020","4120","4220","4320","4420","4530","4640","4750","4870","4990","5110","5230","5360","5490","5620","5760","5900","6040","6190","6340","6490","6650","6810","6980",
    "7150","7320","7500","7680","7870","8060","8250","8450","8660","8870","9090","9310","9530","9760","10000","10200","10500","10700","11000","11300","11500","11800","12100","12400","12700",
    "13000","13300","13700","14000","14300","14700","15000","15400","15800","16200","16500","16900","17400","17800","18200","18700","19100","19600","20000","20500","21000","22100","22600",
    "23200","23700","24300","24900","25500","26100","26700","27400","28000","28700","29400","30100","30900","31600","32400","33200","34000","34800","35700","36500","37400","38300","39200",
    "40200","41200","42200","43200","44200","45300","46400","47500","48700","49900","51100","52300","53600","54900","56200","57600","59000","60400","61900","63400","64900","66500","68100",
    "69800","71500","73200","75000","76800","78700","80600","82500","84500","86600","88700","90900","93100","95300","97600","100000","102000","105000","107000","110000","113000","115000",
    "118000","121000","124000","127000","130000","133000","137000","140000","143000","147000","150000","154000","158000","162000","165000","169000","174000","178000","182000","187000","191000",
    "196000","200000","205000","210000","221000","226000","232000","237000","243000","249000","255000","261000","267000","274000","280000","287000","294000","301000","309000","316000","324000",
    "332000","340000","348000","357000","365000","374000","383000","392000","402000","412000","422000","432000","442000","453000","464000","475000","487000","499000","511000","523000","536000",
    "549000","562000","576000","590000","604000","619000","634000","649000","665000","681000","698000","715000","732000","750000","768000","787000","806000","825000","845000","866000","887000",
    "909000","931000","953000","976000","1000000","1500000","2000000","2490000","3010000","4020000","4990000","5900000","6810000","7500000","8250000","9090000","10000000","15000000","20000000",
    "999999999999999999999999999999999"
]

username_table = 'usernames'

password_table = 'passwords'

#cams_temp_username_learning_tool = {
#    "employee_id" : "username",
#    "08095" : "cbrochu"
#}

#cams_temp_password_learning_tool = {
#    "username" : "password",
#    "cbrochu" : "JarjarB1nks97!"
#}